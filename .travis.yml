language: node_js
node_js:
  - 14

cache:
  yarn: true
  directories:
  - node_modules
  - lib/js-ceramic/node_modules
  - lib/js-ceramic/packages/ceramic-common/node_modules
  - lib/js-ceramic/packages/ceramic-core/node_modules
  - lib/js-ceramic/packages/ceramic-cli/node_modules
  
before_script:
  - npm install -g lerna
  - cd lib/js-ceramic && npm run bootstrap && npm run build
  - cd packages/ceramic-core && yarn link
  - cd ../../../.. && yarn link @ceramicnetwork/ceramic-core

script:
  - yarn run test
  - yarn run build
  